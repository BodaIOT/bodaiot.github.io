<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Page</title>
    <link rel="icon" type="image/x-icon" href="./icon.png" />
    <link rel="stylesheet" href="style.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  </head>
  <body id="body">
    <div id="cover"><div class="FullCenter">–ó–∞–≥—Ä—É–∑–∫–∞</div></div>
    <center>
      <form
        id="fc"
        class="s3"
        style="margin: 0 0 100px 0; color: red; background-color: red"
      >
      <br>
      <br>
      <br>
      <input
        autocomplete="on"
        class="s1"
        name="token"
        id="token"
        placeholder="–í–í–ï–î–ò–¢–ï –¢–û–ö–ï–ù –¢–ï–ú–ü–ï–†–ê–¢–£–†–´ –°–Æ–î–ê"
        required="required"
        type="text"
      />
      <br>
      <input
        autocomplete="on"
        class="s1"
        name="tokenTodoist"
        id="tokenTodoist"
        placeholder="–í–í–ï–î–ò–¢–ï –¢–û–ö–ï–ù –¢–£–î–£–ò–°–¢–ê –°–Æ–î–ê"
        required="required"
        type="text"
      />
      <br>
      <input
        autocomplete="on"
        class="s1"
        name="tokenCoord"
        id="tokenCoord"
        placeholder="–í–í–ï–î–ò–¢–ï –ö–û–û–†–î–ò–ù–ê–¢–´ –ó–ê–ö–ê–¢–ê –°–Æ–î–ê"
        required="required"
        type="text"
      />
      <br>
      <input
        autocomplete="on"
        class="s1"
        name="apiKeyYouTube"
        id="apiKeyYouTube"
        placeholder="–í–í–ï–î–ò–¢–ï –ê–ü–ò –ö–õ–Æ–ß –Æ–¢–£–ë–ê –°–Æ–î–ê"
        required="required"
        type="text"
      />
        <button class="s2" type="submit" id="submitB">
          <img width="28px" height="auto" src="./s.png" alt="" />
        </button>
      </form>
      <span id="content" class="allC">
        <!--
        <form
          action="https://www.yandex.ru/search"
          class="s3"
          method="get"
          name="searchform"
          target="_blank"
        >
          <input
            autocomplete="on"
            class="s1"
            name="text"
            placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å..."
            required="required"
            type="text"
          />
          <button class="s2" type="submit">
            <img width="28px" height="auto" src="./s.png" alt="" />
          </button>
        </form>
        -->
        <div class="t2-container">
          <table class="t2">
            <tr class="t2-tr">
              <th style="width: 490px">
                <div class="rad">
                  <div
                    class="rad bs"
                    id="ww_9e264a3bb9c2a"
                    v="1.3"
                    loc="id"
                    a='{"t":"responsive","lang":"ru","ids":["wl4007"],"font":"Arial","sl_ics":"one_a","cl_bkg":"image","cl_font":"#FFFFFF","cl_cloud":"#FFFFFF","cl_persp":"#81D4FA","cl_sun":"#FFC107","cl_moon":"#FFC107","cl_thund":"#FF5722","el_nme":3,"el_cwi":3,"el_ctm":3}'
                  >
                    <a
                      href="https://weatherwidget.org/"
                      id="ww_9e264a3bb9c2a_u"
                      target="_blank"
                      >Html weather widget</a
                    >
                  </div>
                  <script
                    async
                    src="https://app2.weatherwidget.org/js/?id=ww_9e264a3bb9c2a"
                  ></script>
                </div>
                <div style="display: flex; margin-top: 10px; margin-left: 90px;">
                  <div>
                    <!--
                    <div class="rad tempM bs">
                      <center>
                        <div class="inl">
                          <table class="t1">
                            <tr>
                              <th>
                                <img src="./t.png" class="ti" />
                              </th>
                              <th><span id="t"></span>¬∞C</th>
                            </tr>
                          </table>

                          <table class="t1">
                            <tr>
                              <th>
                                <img src="./h.png" class="hi" />
                              </th>
                              <th><span id="h"></span>%</th>
                            </tr>
                          </table>
                        </div>
                      </center>
                    
                    </div>
                    -->
                  </div>
                  <div class="rad timeM bs">
                    <div class="timeM4">
                      <span class="timeM2" id="clock"></span>
                      <span class="timeM3" id="clock2"></span>
                    </div>
                  </div>

                  <div class="rad zakatM bs">
                    <center>
                      <div class="inl">
                        <table class="t1">
                          <tr>
                            <th>
                              <img src="./r.png" class="rasIcon" />
                            </th>
                            <th><span id="rassvet"></span></th>
                          </tr>
                        </table>

                        <table class="t1">
                          <tr>
                            <th>
                              <img src="./z.png" class="zakIcon" />
                            </th>
                            <th><span id="zakat"></span></th>
                          </tr>
                        </table>
                      </div>
                    </center>
                  </div>
                </div>
              </th>


              <th style="width: auto">
                <div>
                  <div
                    class="rad bs"
                    id="ww_3917d5ed2bc7e"
                    v="1.3"
                    loc="id"
                    a='{"t":"horizontal","lang":"ru","ids":["wl4007"],"font":"Arial","sl_ics":"one_a","sl_sot":"celsius","cl_bkg":"image","cl_font":"#FFFFFF","cl_cloud":"#FFFFFF","cl_persp":"#81D4FA","cl_sun":"#FFC107","cl_moon":"#FFC107","cl_thund":"#FF5722"}'
                  >
                    <a
                      href="https://weatherwidget.org/"
                      id="ww_3917d5ed2bc7e_u"
                      target="_blank"
                      >Html weather widget</a
                    >
                  </div>
                  <script
                    async
                    src="https://app2.weatherwidget.org/js/?id=ww_3917d5ed2bc7e"
                  ></script>
                </div>
              </th>
              <th>
                <div class="todoist bs">
                  <div id="tasks1" class="tasks">
                    <span>–°–µ–≥–æ–¥–Ω—è:</span><hr align="center" width="100%" size="1" color="#fff">
                  </div>
                </div>
              </th>
              <th>
                <div class="todoist bs">
                  <div id="tasks2" class="tasks">
                    <span>–ó–∞–≤—Ç—Ä–∞:</span><hr align="center" width="100%" size="1" color="#fff">
                  </div>
                </div>
              </th>
            </tr>
          </table>
        </div>
        <div class="main-container horizontal-scroll">
          <div id="RSS1" class="cards-wrapper"></div>
          <div id="RSS2" class="cards-wrapper"></div>
        </div>
      </span>
      <span class="mobile">
        <div>
          <div class="rad tempM2 bs">
            <center>
              <div class="inl">
                <table class="t1">
                  <tr>
                    <th>
                      <img src="./t.png" class="ti" />
                    </th>
                    <th><span id="t2"></span>¬∞C</th>
                  </tr>
                </table>

                <table class="t1">
                  <tr>
                    <th>
                      <img src="./h.png" class="hi" />
                    </th>
                    <th><span id="h2"></span>%</th>
                  </tr>
                </table>
              </div>
            </center>
          </div>
        </div>
      </span>
    </center>

    <div id="my_video_button" class="MyYouTubeVideoBUTTON">
      StopGame: —É—Ç—Ä–µ–Ω–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏
    </div>

    <a href="https://bodaiot.github.io/Timer.html">
      <div id="timerButton" class="timerButton">
        <img src="timer.png" alt="" width="27px">
        <div class="timerButtonText">–¢–∞–π–º–µ—Ä</div>
      </div>
    </a>

    <script>
      (function () {
        const apiKeyYouTube = localStorage.getItem("apiKeyYouTube");
        if (!apiKeyYouTube) return; // 1Ô∏è‚É£ –∫–ª—é—á–∞ –Ω–µ—Ç ‚Äî –≤—ã—Ö–æ–¥–∏–º

        const channelID = "UC3G2Z2qfGoOzr8kSQYkFDaQ";
        const reqURL =
          "https://www.googleapis.com/youtube/v3/search" +
          "?part=snippet" +
          "&channelId=" + channelID +
          "&order=date" +
          "&maxResults=1" +
          "&type=video" +
          "&key=" + apiKeyYouTube;

        let video_url = "";

        document.getElementById("my_video_button")
          ?.addEventListener("click", OpenVideo);

        console.log("[YOUTUBE] –ù–∞—á–∞–ª –∑–∞–ø—Ä–æ—Å –∞–¥—Ä–µ—Å–∞ –≤–∏–¥–µ–æ: " + reqURL );

        fetch(reqURL)
          .then(r => r.json())
          .then(data => {
            const videoId = findVideoId(data);
            if (!videoId) return;

            video_url =
              "https://www.youtube.com/watch?v=" +
              videoId +
              "?autoplay=1";

            console.log("[YOUTUBE] –£—Å–ø–µ—à–Ω–æ –∑–∞–ø—Ä–æ—Å–∏–ª –∞–¥—Ä–µ—Å –≤–∏–¥–µ–æ: " + video_url );

            const urlParams = new URLSearchParams(window.location.search);
            const news = urlParams.get("news");

            const now = new Date().getHours();
            if ((now > 5 && now < 10) || news === "true") {
              console.log("[YOUTUBE] –°–µ–π—á–∞—Å " + now + ", –æ—Ç–∫—Ä—ã–≤–∞—é –≤–∏–¥–µ–æ" );
              OpenVideo();
            }
            else {
              console.log("[YOUTUBE] –°–µ–π—á–∞—Å " + now + ", –ù–ï –°–¢–ê–õ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –≤–∏–¥–µ–æ" );
            }
          })
          .catch(err => console.error("YouTube API error:", err));

        function OpenVideo() {
          if (!video_url) {
            console.error("–£ –ú–ï–ù–Ø –ü–£–°–¢–û–ô URL")
            return;
          }
          window.open(video_url, "_blank");
        }

        // üî• –°–£–ü–ï–†-–ù–ê–î–Å–ñ–ù–´–ô –ø–æ–∏—Å–∫ videoId
        function findVideoId(obj) {
          if (!obj || typeof obj !== "object") return null;

          // —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å
          if (obj.id?.videoId) return obj.id.videoId;

          // –µ—Å–ª–∏ API –≤–¥—Ä—É–≥ –ø–æ–º–µ–Ω—è–µ—Ç—Å—è ‚Äî —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –æ–±—Ö–æ–¥
          for (const key in obj) {
            if (!Object.prototype.hasOwnProperty.call(obj, key)) continue;

            const value = obj[key];

            if (key === "videoId" && typeof value === "string") {
              return value;
            }

            if (typeof value === "object") {
              const found = findVideoId(value);
              if (found) return found;
            }
          }

          return null;
        }
      })();
      </script>

    <script src="TempAndClock.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"
    ></script>
    <script src="RSS.js"></script>
    <script src="horizontalScrolling.js"></script>
    <script src="Todoist.js"></script>
    <script>
      $(window).on('load', function() {
        $("#cover").hide();
      });
    </script>
  </body>
</html>
